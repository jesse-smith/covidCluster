.[[1]]
) %>%
select(empdate_any) %>%
.[[1]]
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
transmute(sum(c_across()))
) %>%
select(empdate_any) %>%
.[[1]]
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(sum(c_across()))
) %>%
select(empdate_any) %>%
.[[1]]
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE) %>% as.logical())
) %>%
select(empdate_any) %>%
.[[1]]
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE) %>% as.logical()) %>%
.[[1]]
) %>%
select(empdate_any) %>%
.[[1]]
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE) %>% as.logical()) %>%
.[[1]]
) %>%
create_table(empdate_any)
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE) %>% as.logical()) %>%
.[[1]]
) %>%
create_table(empdate_any) %>%
create_pie()
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any)
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, infreq = FALSE)
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, infreq = FALSE) %>%
create_bar()
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, infreq = FALSE) %>%
create_bar(incl_missing = TRUE)
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, infreq = FALSE) %>%
create_bar(legend_bottom = FALSE)
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
# Create plot
plt <- ggplot2::ggplot(
.table,
ggplot2::aes(x = !!.by, y = n, fill = !!.by)
) +
ggplot2::geom_col(show.legend = legend) +
ggtext::geom_richtext(
ggplot2::aes(
y = n,
label = paste0(
"**", n, "** ",
"(", round(100*pct), "%)"
),
color = !!.by,
),
size = 5,
fill = background,
show.legend = FALSE
) +
ggplot2::scale_color_manual(
name = legend_title,
values = pal(NROW(.table)),
aesthetics = c("color", "fill")
) +
ggplot2::ggtitle(title) +
ggthemes::theme_fivethirtyeight(base_size = 14) +
ggplot2::theme(
plot.title = ggplot2::element_text(
size = 28,
face = "bold",
hjust = 0.5,
color = "gray30"
),
legend.title = ggplot2::element_text(
size = 18,
face = "bold",
color = "grey30"
),
legend.text = ggplot2::element_text(
size = 14,
color = "gray30"
),
legend.background = element_rect(color = NA, fill = background),
legend.box.background = element_rect(color = NA, fill = background),
legend.key = element_rect(color = NA, fill = background),
panel.background = ggplot2::element_rect(color = NA, fill = background),
panel.border = ggplot2::element_blank(),
panel.grid.major = element_blank(),
plot.background = ggplot2::element_rect(color = NA, fill = background),
line = ggplot2::element_blank(),
axis.text = ggplot2::element_text(size = 18)
)
devtools::load_all(".")
# Create plot
plt <- ggplot2::ggplot(
.table,
ggplot2::aes(x = !!.by, y = n, fill = !!.by)
) +
ggplot2::geom_col(show.legend = legend) +
ggtext::geom_richtext(
ggplot2::aes(
y = n,
label = paste0(
"**", n, "** ",
"(", round(100*pct), "%)"
),
color = !!.by,
),
size = 5,
fill = background,
show.legend = FALSE
) +
ggplot2::scale_color_manual(
name = legend_title,
values = pal(NROW(.table)),
aesthetics = c("color", "fill")
) +
ggplot2::ggtitle(title) +
ggthemes::theme_fivethirtyeight(base_size = 14) +
ggplot2::theme(
plot.title = ggplot2::element_text(
size = 28,
face = "bold",
hjust = 0.5,
color = "gray30"
),
legend.title = ggplot2::element_text(
size = 18,
face = "bold",
color = "grey30"
),
legend.text = ggplot2::element_text(
size = 14,
color = "gray30"
),
legend.background = element_rect(color = NA, fill = background),
legend.box.background = element_rect(color = NA, fill = background),
legend.key = element_rect(color = NA, fill = background),
panel.background = ggplot2::element_rect(color = NA, fill = background),
panel.border = ggplot2::element_blank(),
panel.grid.major = element_blank(),
plot.background = ggplot2::element_rect(color = NA, fill = background),
line = ggplot2::element_blank(),
axis.text = ggplot2::element_text(size = 18)
)
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
ggtext::GeomTextBox
ggtext::geom_textbox()
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
ggtext::geom_textbox()
devtools::load_all(".")
ggtext::geom_textbox()
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
?ggtext::geom_textbox
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
devtools::load_all(".")
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", legend_bottom = FALSE)
# Count employed at work during infectious period
completed %>%
filter(employment == "Employed") %>%
mutate(
empdate_any = across(starts_with("emp1date"), ~ !is.na(.x)) %>%
rowwise() %>%
transmute(lgl = sum(c_across(), na.rm = TRUE)) %>%
.[[1]]
) %>%
create_table(empdate_any, show_missing_levels = TRUE, infreq = FALSE) %>%
create_bar(title = "Days Worked While Infectious", x_lab = "Days", y_lab = "People")
